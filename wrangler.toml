name = "topcasts"
main = ".open-next/worker.js"
compatibility_date = "2025-01-01"
compatibility_flags = ["nodejs_compat"]

[observability]
enabled = true

[assets]
directory = ".open-next/assets"
binding = "ASSETS"

# Public environment variables (non-sensitive)
[vars]
NEXT_PUBLIC_SUPABASE_URL = "https://dupqaaqpafucdxrmrmkv.supabase.co"

# Required secrets (set these in Cloudflare Workers dashboard > Settings > Variables)
# For local development, use .dev.vars file
#
# NEXT_PUBLIC_SUPABASE_ANON_KEY - Supabase anonymous/public key
# SUPABASE_SERVICE_KEY - Supabase service role key (admin)
# SUPABASE_JWT_SECRET - Supabase JWT secret for token verification
# SPOTIFY_CLIENT_ID - Spotify API client ID
# SPOTIFY_CLIENT_SECRET - Spotify API client secret
# ct0 - Twitter/X ct0 token
# auth_token - Twitter/X auth token

# Self-reference for revalidation
[[services]]
binding = "WORKER_SELF_REFERENCE"
service = "topcasts"

# R2 bucket for incremental cache
[[r2_buckets]]
binding = "NEXT_INC_CACHE_R2_BUCKET"
bucket_name = "topcasts-cache"

# D1 database for tag cache
[[d1_databases]]
binding = "NEXT_TAG_CACHE_D1"
database_name = "topcasts-tag-cache"
database_id = "0aab0330-fcd7-4749-8f97-0b8a2cb92f81"
